##### 9.1.1 ???????????? ####################################
#---- ???9.1 -----------------------
p <-seq(from=0.1, to=0.9, by=0.1)
windows()
par(mfrow=c(3,3),mai=c(0.5,0.5,0.2,0.1))
for(i in 1:9){
  barplot(dbinom(0:5,size=5,prob=p[i]),
          xlab="x",ylab="p",ylim=c(0,0.6),
          main=substitute(B(5,p),list(p=p[i])),
          cex.main=0.8,col="lightblue")
}

#--- ???9.2 -----------------------
set.seed(123456)
windows()
par(mfrow=c(2,2),mai=c(0.7,0.7,0.4,0.1),cex=0.8)
for (i in 1:4){
  n<-c(100,500,5000,10000)
  d<-table(rbinom(n[i],size=10,prob=0.5))
  barplot(d,xlab="????????????",ylab="??????",col="lightblue",
          main=paste("????????????=",n[i]),cex.main=0.8)
}

#---???9.3 -----------------------

##### 9.2.1 ???????????? #################################
#--- ???9.8 ----------------------
windows()
par(mai=c(0.7,0.7,0.1,0.1),cex=0.8)
curve(dnorm(x,-2,1),from=-6,to=2,
      xlim=c(-6,6),ylab="Density",
      col="red",lwd=2,lty=1)
abline(h=0)
segments(-2,0,-2,dnorm(-2,mean=-2,sd=1),lty=4)
curve(dnorm(x,-2,1.5),from=-7,to=3,add=TRUE,
      col="orange",lwd=2,lty=2)
curve(dnorm(x,2,1.5),from=-3,to=7,add=TRUE,
      col="steelblue",lwd=2,lty=3)
segments(2,0,2,dnorm(2,2,1.5),lty=4)
legend("topright",
       legend=c("N(-2,1)","N(-2,1.5)","N(2,1.5)"),
       col=c("red","orange","steelblue"),
       fill=c("red","orange","steelblue"),
       lty=c(1,2,3),cex=1.5)

#----???9.9--------------------------
set.seed(123456)
x<-rnorm(10000)

windows()
par(mfrow=c(2,2),mai=c(0.8,0.8,0.2,0.2),cex=0.8)
hist(x,breaks = 20,freq = FALSE,labels=TRUE,
     ylim=c(0,0.5),xlim=c(-4,4),
     col="grey80",main="??????20???????????????",cex.main=1)
hist(x,breaks = 20,freq = TRUE,labels=TRUE,
     ylim=c(0,2500),xlim=c(-4,4),
     col="grey80",main="??????20???????????????",cex.main=1)
hist(x,breaks = 10,freq = FALSE,labels=TRUE,
     ylim=c(0,0.5),xlim=c(-4,4),
     col="grey80",main="??????10???????????????",cex.main=1)
hist(x,breaks = 10,freq = TRUE,labels=TRUE,
     ylim=c(0,4000),xlim=c(-4,4),
     col="grey80",main="??????10???????????????",cex.main=1)

#----???9.9--------------------------
windows()
par(mfrow=c(2,2),mai=c(0.8,0.8,0.2,0.2),cex=0.8)
z=seq(-4,4,length=10000)
hist(x,breaks=20,prob=TRUE,labels = TRUE,ylim=c(0,0.5),
     col="grey80",main="??????20???????????????",cex.main=1)
hist(x,breaks=50,prob=TRUE,labels = TRUE,ylim=c(0,0.5),
     col="grey80",main="??????50???????????????",cex.main=1)
hist(x,breaks=100,prob=TRUE,labels = TRUE,ylim=c(0,0.5),
     col="grey80",main="??????20???????????????",cex.main=1)
plot(z,dnorm(z),type="l",lwd=2,main="x???????????????",cex.main=1)

#----???9.10--------------------------
windows()
par(mfrow=c(2,2),mai=c(0.8,0.8,0.2,0.2),cex=0.8)
n <- c(20,100,1000,10000)
for(i in 1:4){
  set.seed(2)
  x<-rnorm(n[i],mean=50,sd=10)
  plot(density(x),xlab="x",main=paste("n=",n[i]),cex.main=1)
  polygon(density(x),col="pink")
}

#---???9.11---------------------------
x<-seq(-4,4,length=1000)
y<-dnorm(x,mean=0,sd=1)
zz<-seq(1,2,length=1000)
yy<-dnorm(zz)-0.005
windows()
plot(x,y,type="l",col="red",lwd=2,lty=1,xlab="z",ylab="Density")
lines(zz,yy,type="h",col="pink")
abline(h=0)
segments(0,0,0,dnorm(0),col="gray",lwd=2,lty=2)
z<-c(1,2)
segments(z,c(0,0),z,dnorm(z,mean = 0,sd=1),col="black",lty=1,lwd=2)
text(x=1,y=0,"z=1",pos=3)
text(x=2,y=0,"z=2",pos=3)
text(x=2,y=dnorm(2),"P(1=z=2)",pos=3)

#---???9.12:sjPlot???dist_norm()-------
install.packages("sjPlot")
library(sjPlot)
windows()
dist_norm(norm=2)
dev.new()
dist_norm(norm=1.2)
#--???9.13---------------------------
windows()
dist_norm(p=0.25)

#--???9.14:??????????????????------------
windows()
curve(pnorm(x),-4,4,col="red",lwd=2)

#--???9.15:??????????????????------------
setwd("E://??????//???????????????//data//mydata")
data.df<-read.csv(".//chap04//data4_1.csv")

install.packages("Hmisc")
library(Hmisc)
windows()
par(mfrow=c(1,2),mai=c(0.7,0.7,0.3,0.1),cex=0.7)
plot(ecdf(data.df$AQI),col="red",pch=19,cex=0.8,
     xlab="AQI",ylab="????????????",
     main="(a) plot???????????????ECDF")
Ecdf(data.df$AQI,q=c(0.25,0.5,0.75),
     xlab="AQI",ylab="????????????",
     main="(b)Ecd???????????????ECDF")

##### 3.??????????????? #########################
# 

##########??????????????????:plot()########################
setwd("E://??????//???????????????//data/mydata//")
data2_1.df<-read.csv(".//chap02//data2_1.csv")
mytable<-table(data2_1.df$??????)
mytable #???????????????


#--???????????????????????????----
windows()
par(mfrow=c(2,2))
attach(data2_1.df)
plot(??????,xlab="??????",ylab="??????",main="?????????",ylim=c(0,20)) #????????????
#plot(???????????????),??????????????????
plot(mytable,xlab="??????",ylab="??????",main="?????????2",ylim=c(0,20))
plot(R,xlab="????????????",ylab="R??????",main="?????????",type="p")#point????????????
detach()

#--???????????????,?????????????????????????????????-----
windows()
par(mfrow=c(2,2))
plot(data2_1.df$R,data2_1.df$Python,xlab="R?????????",ylab="Python??????",type="b") # ?????? vs ?????? #(x,y)
plot(Python~R,data=data2_1.df,xlab="R?????????",ylab="Python??????") #formula:Y~x
plot(R~Python,data=data2_1.df,xlab="Python?????????",ylab="R?????????")
#plot(R,Python,data=data2_1.df,xlab="R?????????",ylab="Python??????")


#--???????????????,????????????(x/y),????????????(y,x) -----
windows()
par(mfrow=c(2,2))
attach(data2_1.df)
plot(R~??????,xlab="??????",ylab="R??????",main="??????vs??????") #????????? formula
plot(Python~R,xlab="R??????",ylab="Python??????",main="??????vs??????") 
plot(??????~R,xlab="R??????",ylab="??????",main="??????vs??????") # ?????????
detach()

#--???????????????????????????-----------------
data("mtcars") # mtcars:R?????????df
mtcars
mtcars$cyl<-as.factor(mtcars$cyl)
mtcars$gear<-as.factor(mtcars$gear)
windows()
plot(cyl~gear,data=mtcars,xlab="gear",ylab="cyl") #????????????formula


#---??????plot???????????????(?????????)--------------
windows()
par(mfrow=c(2,2))
plot(R~Python,data=data2_1.df,xlab="Python??????",
     ylab="R??????",xlim=c(50,70),ylim=c(60,100),
     main="R???Python???????????????_1",
     type="o",col="blue",lwd=1,pch=23)
plot(R~Python,data=data2_1.df,type="b",xlab="Python??????",
     ylab="R??????",xlim=c(50,70),ylim=c(60,100),
     main="R???Python???????????????_2",
     ann=FALSE)
plot(R~Python,data=data2_1.df,type="b",xlab="Python??????",
     ylab="R??????",xlim=c(50,70),ylim=c(60,100),
     main="R???Python???????????????_3",
     axes=FALSE)
plot(R~Python,data=data2_1.df,type="b",xlab="Python??????",
     ylab="R??????",xlim=c(50,70),ylim=c(60,100),
     main="R???Python???????????????_4",
     xaxt="n")

#---??????plot???????????????(??????,??????)------------
#--lty,pch,lwd,col,cex,type-------------------
windows()
plot(R~Python,data=data2_1.df,type="l",xlab="Python??????",
     ylab="R??????",xlim=c(50,85),ylim=c(60,100),
     main="R???Python???????????????_5",
     lty=3,pch=20,lwd=3,col="red",cex.main=1,cex.lab=1)
# «R??????»


################??????????????????#########################
#---abline()?????????------------------------
#---????????????--------
windows()
par(mfrow=c(2,2))
plot(1:5, 1:5, xlim = c(0,6), ylim = c (0,6))
abline(h = 0, col = "red")   #??????????????????
plot(1:5, 1:5, xlim = c(0,6), ylim = c (0,6))
abline(v = 0, col = "blue",lwd=3)  #??????????????????
#?????????????????????????????????
plot(1:5, 1:5, xlim = c(0,6), ylim = c (0,6))
abline(h = c(0,1,2), v = c(0,1,2), 
       col = c("red", "green", "blue"))
#---????????????--------
windows()
plot(1:5, 1:5, xlim = c(0,6), ylim = c (0,6))
abline(h = 0, col = "gray")
abline(v = 0, col = "gray")
abline(a = 1 , b = 1, col = "red",lwd=2,lty=2)
abline(a = 2 ,b = 1, col="blue",lwd=3,lty=4)

#---abline?????????????????????----
data(cars) #mtcars
fit<- lm(dist ~ speed, data = cars)
windows()
par(mfrow=c(1,2))
plot(cars)
abline(fit,col="red")
plot(cars)
abline(a=fit$coefficients[1],b=fit$coefficients[2],
       col="blue",lwd=3)

#---lines()?????????--------------
#---??????1-------
set.seed(0108)
nn<- 100
x<- sort(runif(nn))
eps <- rnorm(nn, mean = 0, sd = 1L)

#Simulated data and True data.
TrueY <- 1+x/2+4*x^2  #x=0,TrueY=1, simuY = 1+0.0001 = 1.00001
# = 1-0.0001 = 0.99999
SimuY <- 1 + x/2 + 4*x^2 + eps

windows()
plot(SimuY~x, type="p",main="Plot of SimuY vs x", cex.main = 1.25)
lines(x, TrueY, lty ="solid", lwd = 4, col = "red")

#--??????2--------
t<-rep(1:8) # 1~8???
v1<-c(245,356,210,189,345,234,191,452) #v1:????????????1~8????????????
v2<-c(345,451,541,548,600,720,650,560) #v2:?????????1~8????????????
windows()
plot(c(1,8),c(100,750),type="n",xlab="??????",ylab="????????????")
abline(h=seq(100,750,by=20),v=0:8,col="lightgray",lty=3)
lines(t,v1,col="red")
lines(t,v2,col="blue")


#--???????????????????????????(«R??????»p52)----
x<-c(1:10)
y<-x
z<-10/x
windows()
opar<-par(no.readonly = TRUE)
par(mar=c(5,4,4,8)+0.1)
plot(x,y,type="b",pch=21,col="red",
     yaxt="n",lty=3,ann=FALSE) 
#yaxt????????????y?????????,ann????????????x??????y????????????
lines(x,z,type="b",pch=22,col="blue",lty=2)
axis(2,at=x,labels=x,col.axis="red",las=2)
axis(4,at=z,labels=round(z,digits=2),
     col.axis="blue",las=2,cex.axis=0.7,tck=-.01)
mtext("y=1/x",side = 4,line=1,las=2,col="blue")
title("An Example of Creative Axes",
      xlab="X values", ylab="Y=X")
par(opar)

#---legend()?????????(«R??????»p80)-----
dose<-c(20,30,40,45,60)
drugA<-c(16,20,27,40,60)
drugB<-c(15,18,25,31,40)
windows()
opar<-par(no.readonly = TRUE)
par(lwd=2,cex=1.5,font.lab=2)
plot(dose,drugA,type="b",pch=15,lty=1,col="red",
     ylim=c(0,60),main="DrugA vs. DrugB",
     xlab="Drug Dosage",ylab="Drug Response")
lines(dose,drugB,type="b",pch=17,lty=2,col="blue")
abline(h=c(30),lwd=1.5,lty=2,col="gray")
legend("top",title="Drug Type",legend=c("A","B"),
       lty=c(1,2),pch=c(15,17),col=c("red","blue"))
par(opar)

#--text()«R??????»---------------
data(mtcars)
attach(mtcars)
windows()
plot(wt,mpg,main="Mileage vs. Car Weight",type="p",
     xlab="Weight",ylab="Mileage",pch=18,col="blue")
text(wt,mpg,rownames(mtcars),cex=1.0,pos=3,col="red")
detach(mtcars)
opar<-par(no.readonly = TRUE)


#--par()??????--------------
set.seed(2015)
xx <- rnorm(100)
windows()
plot(xx)  # ???
# ?????????????????????
windows()
opar <- par(no.readonly=TRUE) 
# ????????????????????????
par(lty=2, pch=17)           
plot(xx) # ???
par(opar)  # ???????????? 
windows()
plot(xx)  # ???
# ??????????????????????????? 


#--????????????---------------
x<-1:10
a<-c("A","B","C","D","E","F","G","H","I","J")
windows()
par(mfrow=c(1,2),mai=c(0.6,0.8,0.2,0.2),
    cex.axis=0.7,cex.lab=1.2,cex.main=1.5)
barplot(x,names=a,col=c("red","green"),
        main="????????????2?????????",ylab="YYY")
barplot(x,names=a,col=1:9,
        main="??????????????????1:9",ylab="ZZZ")



# ??????rainbow()??????-------
windows()
par(mfrow=c(1,2))
n<-10
mycolors<-rainbow(n)
pie(rep(1,n),labels = mycolors, col=mycolors)

#--??????????????????????????????---
windows()
opar<-par(no.readonly = TRUE)
par(mfrow=c(1,2))
par(pin=c(4,3))
par(mai=c(1,0.6,1,.2))
par(lwd=2,cex=0.5)
plot(dose,drugA,type="b",pch=19,lty=2,col="red")
plot(dose,drugB,type="b",pch=23,lty=6,col="blue",bg="green")
par(opar)

#--?????????????????????:mfrow=c(2,2)---
data("mtcars")
windows()
attach(mtcars)
opar<-par(no.readonly = TRUE)
par(mfrow=c(2,2))
plot(wt,mpg,main="Scatterplot of wt vs. mpg")
plot(wt,disp,main="Scatterplot of wt vs. disp")
hist(wt,main="Histogram of wt")
boxplot(wt,main="Boxplot of wt")
par(opar)
detach(mtcars)

#--?????????????????????:layout()---
attach(mtcars)
windows()
layout(matrix(c(1,1,2,3),nrow=2,ncol=2,byrow=TRUE))
hist(wt)
hist(mpg)
hist(disp)
detach(mtcars)

windows()
layout(matrix(c(1,1,1,2,3,4),nrow=2,ncol=3,byrow=TRUE),
       widths=c(4,2,1),heights=c(2,1))
layout.show(4)

#--?????????????????????-----------
# seq(from,to,step),
x=seq(-4*pi,4*pi,0.01)
y=sin(x)
z=cos(x)
windows()
par(mai=c(0.5,1,0.2,0.5))
plot(x,y,main="??????????????????",xlab="X",ylab="y(sin/cos)",
     xlim=c(-10,10),ylim=c(-1,3),
     col="red",type="l",lwd=1,lty=1,yaxt="n")
lines(x,z,col="green",lwd=2,lty=2)
mtext("sin(x)",side=2,line=3,las=2,col="black")
mtext("cos(x)",side=4,las=2,col="black")
axis(2,at=seq(-1,3,0.25),col.axis="red",las=2)
#axis(4,at=seq(-1,3,0.25),col.axis="green",las=2)
legend("topleft",title="sin vs. cos",legend=c("sin(x)","cos(x)"),
       lty=c(1,2),col=c("red","green"),cex=1.5)
abline(h=c(-0.5,0.5,1),v=c(-2*pi,2*pi),col="gray")

#--?????????????????????-----------
data("mtcars")
mtcars$cyl<-factor(mtcars$cyl)
windows()
layout(matrix(c(1,1,2,3),nrow=2,ncol=2,byrow=TRUE),
       widths = c(2,1),heights = c(2,1))
opar<-par(no.readonly=TRUE)
par(pch=17,lty=2,col="red",cex.main=2.0)
plot(mpg~hp,data=mtcars,xlab="HP",ylab="MPG",
     main = "mpg vs. hp")
#par(opar)
#opar<-par(pch=20,lty=1,col="blue",cex=0.7)
boxplot(mpg~cyl,data = mtcars,xlab="CYL",ylab="MPG",
        main="mpg vs. cyl")

hist(mtcars$wt,col="green",xlab="WT",ylab="Density",
     main = "Density of WT")
par(opar)

#??????:p52,???2-14
#???????????????????????????,??????# ?????????????????????



#######????????????###############################
data("cars")
windows()
plot(cars,pch=19)
model1=loess(dist~speed,data=cars,span=0.4)
lines(cars$speed,model1$fit,col='red',lty=2,lwd=2)
model2=loess(dist~speed,data=cars,span=0.8)
lines(cars$speed,model2$fit,col='blue',lty=2,lwd=2)

